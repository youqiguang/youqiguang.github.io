<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜é›…äººç”Ÿé‡å¼€æ¨¡æ‹Ÿå™¨ v3.5 ğŸ§</title>
    <style>
        :root {
            --bg-color: #f0f2f5;
            --card-bg: #ffffff;
            --primary: #2c3e50;
            --text-main: #333;
            --accent: #d35400;
            --highlight-bg: rgba(231, 76, 60, 0.08);
        }

        * { box-sizing: border-box; }

        body {
            font-family: 'Helvetica Neue', Helvetica, 'PingFang SC', 'Microsoft YaHei', Arial, sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: var(--text-main);
            transition: background-color 0.8s ease, color 0.8s ease;
            background-image: radial-gradient(#dce4ec 1px, transparent 1px);
            background-size: 20px 20px;
        }

        body.mode-xiuxian { --bg-color: #e8f5e9; --primary: #2e7d32; --card-bg: #f1f8e9; background-image: none; }
        body.mode-2d { --bg-color: #fce4ec; --primary: #c2185b; --card-bg: #fff0f5; background-image: none; }
        body.mode-horror { --bg-color: #1a1a1a; --primary: #000; --card-bg: #2a2a2a; --text-main: #b0bec5; background-image: none; }
        body.mode-cthulhu { --bg-color: #1b2838; --primary: #0a3d2e; --card-bg: #253447; --text-main: #8fa3b0; background-image: none; }
        body.mode-xuanhuan { --bg-color: #fff3e0; --primary: #e65100; --card-bg: #ffe0b2; background-image: none; }

        .container {
            width: 100%;
            max-width: 500px;
            background: var(--card-bg);
            border-radius: 24px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 90vh;
            position: relative;
            transition: all 0.8s ease;
        }

        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.01); }
        }
        body.mode-2d .container { animation: heartbeat 1.5s infinite; }

        .header {
            background: var(--primary);
            color: white;
            padding: 15px;
            text-align: center;
            font-size: 1.2rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: background 0.8s ease;
            z-index: 10;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .penguin-icon { font-size: 1.5rem; animation: waddle 1s infinite alternate; }
        @keyframes waddle { from { transform: rotate(-10deg); } to { transform: rotate(10deg); } }

        .screen { padding: 25px; flex: 1; display: none; flex-direction: column; overflow-y: auto; }
        .screen.active { display: flex; }

        .start-screen { text-align: center; justify-content: center; }
        .meme-banner { font-size: 70px; margin: 20px 0; animation: float 3s ease-in-out infinite; }
        @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-15px); } }
        .subtitle { font-size: 0.9rem; color: #666; margin-top: 10px; font-style: italic; }
        .version-info { margin-top: 30px; font-size: 0.8rem; color: #999; text-align: left; background: #f8f9fa; padding: 15px; border-radius: 10px; }
        .special-hint { color: var(--accent); font-weight: bold; }
        .warning-box { background: #fff3cd; border-left: 4px solid #ff6b6b; padding: 12px; margin-top: 15px; border-radius: 8px; color: #856404; font-size: 0.85rem; }

        .btn {
            background: var(--primary); color: white; border: none; padding: 16px 32px; font-size: 1.05rem;
            border-radius: 50px; cursor: pointer; margin-top: 25px; box-shadow: 0 6px 15px rgba(0,0,0,0.1);
            transition: all 0.2s; font-weight: bold; letter-spacing: 1px;
        }
        .btn:active { transform: scale(0.95); }
        #restart-btn { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); display: none; z-index: 100; width: 85%; max-width: 460px; }

        .setup-screen h2 { text-align: center; margin-bottom: 25px; color: var(--primary); }
        .gender-select { display: flex; justify-content: center; gap: 10px; margin-bottom: 25px; flex-wrap: wrap; }
        .gender-btn { padding: 10px 20px; border: 2px solid #ddd; background: transparent; border-radius: 12px; cursor: pointer; color: var(--text-main); font-weight: bold; transition: all 0.2s; font-size: 0.9rem; }
        .gender-btn.selected { background: var(--primary); color: white; border-color: var(--primary); }
        .points-counter { text-align: center; font-weight: bold; margin-bottom: 20px; font-size: 1.1rem; }

        .stat-row { margin-bottom: 18px; display: flex; align-items: center; gap: 12px; background: #f8f9fa; padding: 10px; border-radius: 12px; }
        .stat-label { width: 60px; font-weight: bold; display: flex; align-items: center; gap: 5px; font-size: 0.9rem; }
        input[type="range"] { flex: 1; accent-color: var(--primary); cursor: pointer; height: 6px; }
        .stat-val { font-weight: bold; color: var(--primary); width: 30px; text-align: right; }

        #log-container { flex: 1; overflow-y: auto; padding-bottom: 120px; scroll-behavior: smooth; -webkit-overflow-scrolling: touch; }
        .log-item {
            padding: 12px 5px;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            font-size: 0.95rem;
            line-height: 1.6;
            opacity: 0;
            animation: slideUp 0.4s ease-out forwards;
        }
        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .age-tag {
            display: inline-block; background: var(--primary); color: white; padding: 3px 8px; border-radius: 6px;
            font-size: 0.75rem; margin-right: 10px; min-width: 32px; text-align: center; font-weight: bold;
        }

        .highlight { color: #c0392b; font-weight: bold; background: var(--highlight-bg); padding: 2px 6px; border-radius: 4px; }
        .golden { color: #f39c12; font-weight: 900; text-shadow: 1px 1px 0 rgba(0,0,0,0.1); }
        
        .xiuxian-text { color: #2e7d32; font-weight: bold; }
        .anime-text { color: #d81b60; }
        .horror-text { color: #ff5252; font-weight: bold; }
        .cthulhu-text { color: #4db6ac; font-style: italic; }
        .xuanhuan-text { color: #ff6f00; font-weight: bold; }

        .choice-box {
            background: rgba(255,255,255,0.95);
            border: 2px solid var(--primary);
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
        }
        .choice-title { font-weight: bold; margin-bottom: 12px; color: var(--primary); font-size: 1rem; }
        .choice-btn {
            display: block;
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            background: #eceff1;
            border: 2px solid #b0bec5;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
            color: #333;
            text-align: left;
        }
        .choice-btn:active { transform: scale(0.98); background: var(--primary); color: white; border-color: var(--primary); }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.6);
            justify-content: center;
            align-items: center;
        }
        .modal.active { display: flex; }
        .modal-content {
            background: white;
            padding: 25px;
            border-radius: 16px;
            max-width: 350px;
            width: 85%;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        .modal-content h3 { margin-top: 0; color: #c0392b; }
        .modal-btn {
            padding: 12px 24px;
            margin: 8px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
        }
        .modal-btn.confirm { background: #e74c3c; color: white; }
        .modal-btn.cancel { background: #95a5a6; color: white; }
        .modal-btn:active { transform: scale(0.95); }

    </style>
</head>
<body>

<div class="container">
    <div class="header" id="header-bar">
        <span class="penguin-icon">ğŸ§</span>
        <span id="title-text">é«˜é›…äººç”Ÿæ¨¡æ‹Ÿå™¨</span>
        <span class="penguin-icon">ğŸ·</span>
    </div>

    <div id="screen-start" class="screen active start-screen">
        <div class="meme-banner">ğŸ•´ï¸ğŸ²ğŸ¦‘</div>
        <h1>äººç”Ÿé‡å¼€ v3.5</h1>
        <p class="subtitle">"åšäººå¤ªç´¯äº†ï¼Œä¸å¦‚åšä¸ªé«˜é›…çš„ä¼é¹…ã€‚"</p>
        
        <div class="version-info">
            <strong>æœ¬å‘¨ç›®ç‰¹è‰²ï¼š</strong><br>
            â€¢ å¯è½¬ç”Ÿä¸ºéäººç±»ç‰©ç§<br>
            â€¢ éšæœºæš´æ¯™ç³»ç»Ÿ<br>
            â€¢ <span class="special-hint">å¤šæ¡ä¸–ç•Œçº¿ä¸äº’åŠ¨é€‰æ‹©</span>
        </div>

        <div class="warning-box">
            âš ï¸ <strong>å†…å®¹è­¦å‘Šï¼š</strong>æœ¬æ¸¸æˆå«å¾®ææ€–å‘å†…å®¹ï¼Œå¿ƒç†æ‰¿å—èƒ½åŠ›è¾ƒå¼±è€…è¯·è°¨æ…æ¸¸ç©
        </div>
        
        <button class="btn" onclick="goToSetup()">å¼€å§‹æŠ½å¡</button>
    </div>

    <div id="screen-setup" class="screen setup-screen">
        <h2>å®šåˆ¶ä½ çš„å¤©èµ‹ (20ç‚¹)</h2>
        <div class="gender-select">
            <button class="gender-btn selected" onclick="selectGender('male', this)">ç”·</button>
            <button class="gender-btn" onclick="selectGender('female', this)">å¥³</button>
            <button class="gender-btn" onclick="selectGender('other', this)">???</button>
        </div>
        
        <div class="points-counter" style="color:var(--accent)">
            å‰©ä½™ç‚¹æ•°: <span id="points-display">20</span>
        </div>

        <div id="sliders-container"></div>

        <button class="btn" onclick="startGame()">å¼€å¯éšæœºäººç”Ÿ</button>
    </div>

    <div id="screen-game" class="screen game-screen">
        <div id="log-container"></div>
        <button id="restart-btn" class="btn" onclick="resetGame()">å†æ¬¡é‡å¼€</button>
    </div>
</div>

<div id="horror-modal" class="modal">
    <div class="modal-content">
        <h3>âš ï¸ æ³¨æ„</h3>
        <p>å³å°†è¿›å…¥<strong id="modal-mode-name">ææ€–</strong>æ¨¡æ‹Ÿå™¨çº¿è·¯</p>
        <p style="font-size: 0.9rem; color: #666;">è¯¥çº¿è·¯åŒ…å«å¾®ææ€–å†…å®¹ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ</p>
        <button class="modal-btn confirm" onclick="confirmHorrorMode()">ç»§ç»­æ¸¸ç©</button>
        <button class="modal-btn cancel" onclick="cancelHorrorMode()">å–æ¶ˆ</button>
    </div>
</div>

<script>
const TOTAL_POINTS = 20;
const statConfig = [
    { key: 'face', name: 'é¢œå€¼', icon: 'ğŸ’…' },
    { key: 'iq', name: 'æ™ºå•†', icon: 'ğŸ§ ' },
    { key: 'body', name: 'ä½“è´¨', icon: 'ğŸ’ª' },
    { key: 'money', name: 'å®¶å¢ƒ', icon: 'ğŸ’°' },
    { key: 'luck', name: 'æ°”è¿', icon: 'ğŸ€' }
];

const speciesList = ['é«˜é›…ä¼é¹…', 'æ°´è±š', 'èµ›åšèŸ‘è‚', 'ä¸€æ£µæ ‘', 'å²è±å§†'];

let remainingPoints = TOTAL_POINTS;
let stats = { face:0, iq:0, body:0, money:0, luck:0 };
let selectedGenderTag = 'male';
let finalGenderOrSpecies = 'äººç±»ç”·æ€§';
let age = 0;
let isDead = false;
let gameInterval = null;
let currentMode = 'normal';
let pendingHorrorMode = null;
let recentEvents = []; // ç”¨äºå»é‡

// ----------------- å‰§æƒ…åº“ -----------------

// äººç±»åˆ†é¾„å‰§æƒ…æ± 
const humanEvents = {
    baby: [ // 0-3å²
        "ä½ è¯•å›¾ç¿»èº«ï¼Œä½†å› ä¸ºå¤ªèƒ–å¤±è´¥äº†ã€‚", "ä½ æŠ“ä½äº†å¤§äººçš„æ‰‹æŒ‡ï¼Œä»–ä»¬ç¬‘å¾—å¾ˆå¼€å¿ƒã€‚", "å¥¶ç²‰å¤ªçƒ«äº†ï¼Œä½ å¤§å“­ä¸€åœºã€‚", 
        "ä½ å°¿åºŠäº†ï¼Œæ„Ÿè§‰æš–æ´‹æ´‹çš„ã€‚", "ä½ åœ¨åœ°æ¿ä¸Šçˆ¬è¡Œï¼Œå‘ç°äº†ä¸€é¢—ç°å°˜ã€‚", "ä½ å­¦ä¼šäº†å–Š'å¦ˆå¦ˆ'ï¼Œå…¨å®¶éƒ½å¾ˆæ¿€åŠ¨ã€‚",
        "æ‰“ç–«è‹—çš„æ—¶å€™ä½ å“­å¾—æ’•å¿ƒè£‚è‚ºã€‚", "ç”±äºé•¿å¾—å¯çˆ±ï¼Œéš”å£é˜¿å§¨æ€»æƒ³æä½ çš„è„¸ã€‚", "ä½ æŠŠç©å…·å¡è¿›äº†å˜´é‡Œã€‚"
    ],
    child: [ // 4-12å²
        "ä¸Šå¹¼å„¿å›­ç¬¬ä¸€å¤©ï¼Œä½ å› ä¸ºæŠ¢ç§¯æœ¨å’Œäººæ‰“äº†ä¸€æ¶ã€‚", "ä½ åœ¨å…¬å›­æŠ“åˆ°äº†ä¸€åªç‹¬è§’ä»™ã€‚", "ä¸æƒ³å†™ä½œä¸šï¼Œè¢«å¦ˆå¦ˆéª‚äº†ä¸€é¡¿ã€‚",
        "ä½ å·åƒäº†å†°ç®±é‡Œçš„å¸ƒä¸ã€‚", "è€ƒè¯•å¾—äº†åŒç™¾ï¼Œå¥–åŠ±æ˜¯ä¸€é¡¿è‚¯å¾·åŸºã€‚", "ä½ å’Œé‚»å±…å®¶çš„å°å­©æˆäº†æ­»å…šã€‚",
        "å› ä¸ºæŒ‘é£Ÿè¢«çˆ¶æ¯æ··åˆåŒæ‰“ã€‚", "ä½ å¼€å§‹æ€è€ƒå¥¥ç‰¹æ›¼æ˜¯ä¸æ˜¯çœŸçš„å­˜åœ¨ã€‚", "åœ¨å­¦æ ¡è¿åŠ¨ä¼šä¸Šæ‘”äº†ä¸€è·¤ï¼Œå¾ˆä¸¢è„¸ã€‚"
    ],
    teen: [ // 13-18å²
        "é’æ˜¥æœŸåˆ°äº†ï¼Œè„¸ä¸Šå¼€å§‹é•¿ç—˜ç—˜ã€‚", "æš—æ‹éš”å£ç­çš„åŒå­¦ï¼Œä½†ä¸æ•¢è¡¨ç™½ã€‚", "ç¹é‡çš„è¯¾ä¸šè®©ä½ å–˜ä¸è¿‡æ°”ã€‚",
        "å·å·å»ç½‘å§è¢«æŠ“äº†ä¸ªç°è¡Œã€‚", "ä½ åœ¨æ—¥è®°æœ¬ä¸Šå†™æ»¡äº†ä¸­äºŒçš„å¹»æƒ³ã€‚", "ä½“è‚²è¯¾ä¸Šä½ æŠ•è¿›äº†ä¸€ä¸ªå¸…æ°”çš„ä¸‰åˆ†çƒã€‚",
        "ç”±äºæ²‰è¿·å°è¯´ï¼Œæˆç»©ä¸‹æ»‘äº†ã€‚", "ä½ å¼€å§‹è§‰å¾—çˆ¶æ¯å¾ˆå” å¨ã€‚", "é«˜è€ƒå‰å¤œï¼Œä½ å¤±çœ äº†ã€‚"
    ],
    adult: [ // 19-50å²
        "å¤§å­¦ç”Ÿæ´»æ¯”æƒ³è±¡ä¸­æ›´è‡ªç”±ï¼Œä¹Ÿæ›´è¿·èŒ«ã€‚", "ä½ ä¸ºäº†æŠ¢é€‰ä¿®è¯¾ç†¬å¤œå®ˆåœ¨ç”µè„‘å‰ã€‚", "æ¯•ä¸šæ±‚èŒå››å¤„ç¢°å£ã€‚",
        "ç¬¬ä¸€ä»½å·¥èµ„ä½ è¯·çˆ¶æ¯åƒäº†ä¸€é¡¿é¥­ã€‚", "è¢«å‚¬å©šçš„å‹åŠ›è¶Šæ¥è¶Šå¤§ã€‚", "åŠ ç­åˆ°æ·±å¤œï¼Œçœ‹åˆ°åŸå¸‚çš„éœ“è™¹ç¯ã€‚",
        "ä½ å…»äº†ä¸€åªçŒ«ï¼Œæˆä¸ºäº†é“²å±å®˜ã€‚", "å‚åŠ åŒå­¦èšä¼šï¼Œå‘ç°å¤§å®¶å˜åŒ–å¾ˆå¤§ã€‚", "ä¸ºäº†æˆ¿è´·ï¼Œä½ ä¸å¾—ä¸æ›´åŠ åŠªåŠ›å·¥ä½œã€‚",
        "ä½ åœ¨ç½‘ç»œä¸Šå›´è§‚äº†ä¸€åœºéª‚æˆ˜ï¼Œæ„Ÿè§‰å¾ˆæ— èŠã€‚", "ä½“æ£€æŠ¥å‘Šä¸Šå‡ºç°äº†ä¸€äº›å°ç®­å¤´ã€‚", "å‘¨æœ«åªæƒ³èººåœ¨åºŠä¸Šä»€ä¹ˆéƒ½ä¸åšã€‚"
    ],
    old: [ // 51-100å²
        "é€€ä¼‘ç”Ÿæ´»å¼€å§‹äº†ï¼Œä½ è¿·ä¸Šäº†å¹¿åœºèˆã€‚", "å„¿å¥³å·¥ä½œå¾ˆå¿™ï¼Œä½ å­¦ä¼šäº†è‡ªå·±åšé¥­ã€‚", "è§†åŠ›ä¸‹é™ï¼Œçœ‹æŠ¥çº¸éœ€è¦è€èŠ±é•œã€‚",
        "ä½ åœ¨å…¬å›­ä¸‹æ£‹ï¼Œèµ¢äº†éš”å£è€ç‹ã€‚", "å›å¿†å¾€äº‹ï¼Œæœ‰äº›é—æ†¾ä½†ä¹Ÿç®—å……å®ã€‚", "èº«ä½“å¤§ä¸å¦‚å‰ï¼Œå¼€å§‹å…³æ³¨å…»ç”Ÿã€‚",
        "å­™å­å­™å¥³æ¥æ¢æœ›ï¼Œæ˜¯ä½ æœ€å¼€å¿ƒçš„æ—¶åˆ»ã€‚", "è€æœ‹å‹ä¸€ä¸ªä¸ªç¦»å¼€äº†ï¼Œä½ æ„Ÿåˆ°å­¤ç‹¬ã€‚", "ä½ åœ¨é˜³å…‰ä¸‹æ‰“äº†ä¸ªç›¹ï¼Œæ¢¦è§äº†å¹´è½»çš„æ—¶å€™ã€‚"
    ]
};

const speciesEvents = {
    'é«˜é›…ä¼é¹…': [
        "ä½ æ··å…¥äº†äººç±»çš„é«˜çº§æ™šå®´ï¼Œæ²¡äººå‘ç°ã€‚", "ä½ åœ¨è…¾è®¯æ€»éƒ¨å‰å¾˜å¾Šï¼Œè¯•å›¾è®¤ç¥–å½’å®—ã€‚", "ä½ å­¦ä¼šäº†ç”¨çº¢é…’æ¯è£…é±¼æ±¤ã€‚",
        "ä½ ä¼˜é›…åœ°æ»‘è¡Œåœ¨å†°é¢ä¸Šã€‚", "äººç±»å¤¸ä½ 'å¥½ç»…å£«'ã€‚", "ä½ å› å·åƒæåœ°ç§‘è€ƒç«™çš„ç½å¤´è¢«é€šç¼‰ã€‚"
    ],
    'æ°´è±š': [
        "ä½ åœ¨æ¸©æ³‰é‡Œæ³¡äº†ä¸€æ•´å¤©ã€‚", "ä¸€åªé³„é±¼è¯•å›¾åƒä½ ï¼Œåæ¥ä½ ä»¬æˆäº†æœ‹å‹ã€‚", "è¿™ä¸–ç•Œå¤ªä¹±ï¼Œä½ åªæƒ³å‘å‘†ã€‚",
        "ä½ çš„å¤´ä¸Šé¡¶ç€ä¸€åªæ©˜å­ã€‚", "æ— è®ºå‘ç”Ÿä»€ä¹ˆï¼Œä½ éƒ½å¿ƒå¦‚æ­¢æ°´ã€‚", "ä½ è¢«äººç±»è¯„ä¸º'æƒ…ç»ªæœ€ç¨³å®šçš„ç”Ÿç‰©'ã€‚"
    ],
    'èµ›åšèŸ‘è‚': [
        "ä½ åœ¨æ ¸åºŸå¢Ÿä¸­é†’æ¥ï¼Œèº«ä½“é—ªçƒç€éœ“è™¹å…‰ã€‚", "ä½ è¯•å›¾å•ƒé£Ÿé«˜å‹ç”µçº¿å……é¥¥ã€‚", "ä½ é»‘å…¥äº†ä¸€å°è‡ªåŠ¨è´©å–æœºã€‚",
        "äººç±»è¯•å›¾è¸©æ­»ä½ ï¼Œä½†ä½ ç¡¬åº¦æƒŠäººã€‚", "ä½ ä¼ æ’­äº†ä¸€ç§ç”µå­ç—…æ¯’ã€‚", "ä½ åœ¨ä¸‹æ°´é“å»ºç«‹äº†è‡ªå·±çš„æ•°æ®ç‹å›½ã€‚"
    ],
    'ä¸€æ£µæ ‘': [
        "å…‰åˆä½œç”¨ä¸­...æ„Ÿè§‰å¾ˆå……å®ã€‚", "ä¸€åªç‹—åœ¨ä½ è„šä¸‹æ’’å°¿ï¼Œä½ å¾ˆç”Ÿæ°”ä½†åŠ¨ä¸äº†ã€‚", "é¸Ÿå„¿åœ¨ä½ å¤´é¡¶ç­‘å·¢ã€‚",
        "ç”±äºé•¿å¾—å¤ªæ­ªï¼Œèº²è¿‡äº†ä¼æœ¨å·¥çš„ç”µé”¯ã€‚", "å¹²æ—±å­£èŠ‚ï¼Œä½ åŠªåŠ›å‘ä¸‹æ‰æ ¹ã€‚", "å‡ ä¸ªå­©å­åœ¨ä½ èº«ä¸Šåˆ»äº†å­—ã€‚"
    ],
    'å²è±å§†': [
        "ä½ å˜æˆäº†ä¸€æŠŠæ¤…å­çš„å½¢çŠ¶ã€‚", "ä½ åå™¬äº†ä¸€æŠŠç”Ÿé”ˆçš„å‰‘ã€‚", "å†’é™©è€…æŠŠä½ å½“æˆäº†ä½çº§æ€ªï¼Œä½ åæ€äº†ã€‚",
        "ä½ æ„Ÿè§‰èº«ä½“å¾ˆQå¼¹ã€‚", "ä½ åˆ†è£‚å‡ºäº†ä¸€ä¸ªå°å·ã€‚", "ä½ åœ¨è‰ä¸›é‡Œç¡è§‰ï¼Œè¢«è¸©äº†ä¸€è„šã€‚"
    ]
};

// ç‰¹æ®Šæ¨¡å¼å‰§æƒ…
const xiuxianEvents = [
    "ä½ æ„Ÿè§‰åˆ°ç©ºæ°”ä¸­æœ‰å¥‡å¦™çš„æ³¢åŠ¨ï¼Œå¼•æ°”å…¥ä½“ï¼", "ä½ åœ¨åœ°æ‘Šä¸Šä¹°åˆ°äº†ä¸€æœ¬å‘å…‰çš„å¤ç±ã€‚", "é—­å…³ä¿®ç‚¼ä¸­ï¼Œå¢ƒç•Œæ¾åŠ¨ã€‚",
    "ä½ å¾¡å‰‘é£è¡Œé€å¤–å–ï¼Œä»æœªè¶…æ—¶ã€‚", "å°è¯•çªç ´ï¼Œå¤©é™é›·åŠ«ï¼", "ä½ ç‚¼åˆ¶äº†ä¸€ç‚‰ä¸¹è¯ï¼ŒæŠŠè‡ªå·±åƒåäº†è‚šå­ã€‚",
    "å®—é—¨å¤§æ¯”ï¼Œä½ é™©èƒœå¯¹æ‰‹ã€‚", "ä½ åœ¨ç§˜å¢ƒä¸­æ¡åˆ°ä¸€æŠŠæ–­å‰‘ã€‚", "å¸ˆå¦¹å¯¹ä½ æš—é€ç§‹æ³¢ï¼Œä½ å¿ƒä¸­åªæœ‰å¤§é“ã€‚",
    "è·¯è§ä¸å¹³ï¼Œä½ éšæ‰‹ç­äº†ä¸€ä¸ªå±±è´¼å¯¨å­ã€‚"
];

const loveEvents = [
    "ç”»é£çªå˜ï¼Œå‘¨å›´çš„äººçœ¼ç›éƒ½å˜å¤§äº†ï¼", "å­¦æ ¡è½¬æ¥ç¥ç§˜è½¬æ ¡ç”Ÿï¼Œååœ¨åæ’é çª—ã€‚", "ä½ åœ¨å›¾ä¹¦é¦†ä¸TAå››ç›®ç›¸å¯¹ã€‚",
    "æ”¶åˆ°äº†ä¸€å°åŒ¿åæƒ…ä¹¦ï¼Œå­—è¿¹æ¸…ç§€ã€‚", "æ–‡åŒ–ç¥­å½“å¤©ï¼Œç­çº§å†³å®šå¼€æ‰§äº‹å’–å•¡å…ã€‚", "ä¸‹é›¨å¤©æ²¡å¸¦ä¼ï¼ŒTAæŠŠä¼å€Ÿç»™äº†ä½ ã€‚",
    "æ”¾å­¦åè¢«çº¦åˆ°å¤©å°ã€‚", "ä¸€èµ·åšå€¼æ—¥ï¼Œæ°”æ°›æš§æ˜§ã€‚", "ä¸å°å¿ƒæ’åˆ°äº†éœ¸é“æ€»è£/å‚²å¨‡æ ¡èŠ±ã€‚", "åœ¨è¿™ä¸ªçœ‹è„¸çš„ä¸–ç•Œï¼Œä½ å¦‚é±¼å¾—æ°´ã€‚"
];

const horrorEvents = [
    "ä»Šæ™šçš„æœˆäº®æ˜¯çº¢è‰²çš„ï¼Œåƒè¡€ä¸€æ ·ã€‚", "é•œå­é‡Œçš„ä½ æ²¡æœ‰çœ¨çœ¼ï¼Œè¿˜å¯¹ä½ ç¬‘äº†ã€‚", "æ€»æ„Ÿè§‰èº«åæœ‰è„šæ­¥å£°ï¼Œå›å¤´å´æ²¡äººã€‚",
    "æ”¶åˆ°äº†è‡ªå·±å·ç å‘æ¥çš„çŸ­ä¿¡ï¼š'ä¸è¦å›å¤´'ã€‚", "åŠå¤œé†’æ¥ï¼Œæˆ¿é—´é‡Œå¤šäº†ä¸€ä¸ªå½±å­ã€‚", "æ¥¼ä¸Šä¼ æ¥å¼¹ç è½åœ°çš„å£°éŸ³ï¼Œä½†æ¥¼ä¸Šæ²¡äººä½ã€‚",
    "å®¶é‡Œçš„ç©å¶ä¼¼ä¹æ¢äº†ä¸ªä½ç½®ã€‚", "ä½ å¬åˆ°å¢™å£é‡Œæœ‰æŠ“æŒ çš„å£°éŸ³ã€‚", "ç”µæ¢¯åœåœ¨äº†ä¸å­˜åœ¨çš„æ¥¼å±‚ã€‚", "ç”µè§†æœºåœ¨åŠå¤œè‡ªåŠ¨æ‰“å¼€ï¼Œå…¨æ˜¯é›ªèŠ±å±ã€‚"
];

const cthulhuEvents = [
    "ä½ åœ¨æµ·è¾¹æ¡åˆ°åˆ»ç€è¯¡å¼‚ç¬¦å·çš„çŸ³å¤´ã€‚", "æ¢¦è§æ·±æµ·ä¸­æœ‰ä»€ä¹ˆåœ¨å‘¼å”¤ä½ çš„åå­—ã€‚", "ä½ å¼€å§‹å¯¹å¤è€çš„æ–‡æ˜äº§ç”Ÿç—…æ€çš„å…´è¶£ã€‚",
    "é˜…è¯»ç¦å¿Œä¹¦ç±ï¼Œç†æ™ºå€¼ä¸‹é™ï¼ŒçŸ¥è¯†å¢åŠ äº†ã€‚", "ä½ çœ‹åˆ°äº†ä¸è¯¥çœ‹çš„ä¸œè¥¿ï¼Œsanå€¼ç‹‚æ‰ã€‚", "é‚»å±…çš„é•¿ç›¸è¶Šæ¥è¶Šåƒé±¼ã€‚",
    "å¤©ç©ºä¸­çš„æ˜Ÿæ˜Ÿä½ç½®ä¸å¯¹åŠ²ã€‚", "ä½ å¬åˆ°äº†æ— æ³•åçŠ¶çš„ä½è¯­ã€‚", "ä½ çš„çš®è‚¤ä¸Šé•¿å‡ºäº†å¥‡æ€ªçš„é³ç‰‡ã€‚", "ä½ ç”»å‡ºçš„ç”»è®©æ‰€æœ‰äººæ„Ÿåˆ°æ¶å¿ƒã€‚"
];

const xuanhuanEvents = [
    "ä½ ä½“å†…è§‰é†’äº†è¿œå¤ç¥å…½è¡€è„‰ï¼", "å¤©é™å¼‚è±¡ï¼Œç´«æ°”ä¸œæ¥ä¸‰ä¸‡é‡Œï¼", "è·å¾—äº†ä¸€æšç¥ç§˜æˆ’æŒ‡ï¼Œé‡Œé¢ä½ç€è€çˆ·çˆ·ã€‚",
    "é‡åˆ°äº†ç»ä¸–é«˜äººæŒ‡ç‚¹ï¼ŒåŠŸåŠ›å¤§å¢ã€‚", "ä½ çš„å¤©èµ‹éœ‡æƒŠäº†å››å¤§å®—é—¨ã€‚", "é€€å©šæµå¼€å±€ï¼Œä¸‰åå¹´æ²³ä¸œä¸‰åå¹´æ²³è¥¿ã€‚",
    "ä½ æ¡åˆ°ä¸€é¢—ç¥å…½è›‹ã€‚", "è¿›å…¥ä¸Šå¤é—è¿¹ï¼Œè·å¾—ä¼ æ‰¿ã€‚", "å“ªæ€•èƒŒè´Ÿå¤©æ¸Šï¼Œéœ€ä¸€æ‰‹æ‰˜åŸå§‹å¸åŸ...", "ä½ æˆä¸ºäº†ä¼ è¯´ä¸­çš„ä½é¢ä¹‹å­ã€‚"
];

// ----------------- åŠŸèƒ½å‡½æ•° -----------------

function initSetup() {
    const container = document.getElementById('sliders-container');
    container.innerHTML = '';
    statConfig.forEach(stat => {
        container.innerHTML += `
            <div class="stat-row">
                <label class="stat-label">${stat.icon} ${stat.name}</label>
                <input type="range" min="0" max="10" value="0" data-key="${stat.key}" oninput="handleInput('${stat.key}', this.value)">
                <span class="stat-val" id="val-${stat.key}">0</span>
            </div>`;
    });
    resetStatsUI();
}

function resetStatsUI() {
    remainingPoints = TOTAL_POINTS;
    for(let k in stats) stats[k] = 0;
    document.querySelectorAll('input[type="range"]').forEach(el => el.value = 0);
    document.querySelectorAll('.stat-val').forEach(el => el.innerText = '0');
    updatePointDisplay();
}

function handleInput(key, val) {
    val = parseInt(val);
    let used = 0;
    document.querySelectorAll('input[type="range"]').forEach(input => {
        if(input.dataset.key !== key) used += parseInt(input.value);
    });
    
    if (used + val > TOTAL_POINTS) {
        val = TOTAL_POINTS - used;
        document.querySelector(`input[data-key="${key}"]`).value = val;
    }
    
    stats[key] = val;
    document.getElementById(`val-${key}`).innerText = val;
    remainingPoints = TOTAL_POINTS - (used + val);
    updatePointDisplay();
}

function updatePointDisplay() {
    const pDisplay = document.getElementById('points-display');
    pDisplay.innerText = remainingPoints;
    pDisplay.style.color = remainingPoints === 0 ? '#27ae60' : '#d35400';
}

function selectGender(tag, btn) {
    selectedGenderTag = tag;
    document.querySelectorAll('.gender-btn').forEach(b => b.classList.remove('selected'));
    btn.classList.add('selected');
}

function switchScreen(screenId) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById(screenId).classList.add('active');
}

function goToSetup() { switchScreen('screen-setup'); }

function startGame() {
    if (remainingPoints > 0) { alert("å±æ€§ç‚¹æ²¡åˆ†å®Œï¼"); return; }
    
    switchScreen('screen-game');
    
    age = -1; isDead = false; currentMode = 'normal';
    recentEvents = []; // æ¸…ç©ºå†å²
    document.body.className = '';
    document.getElementById('log-container').innerHTML = '';
    document.getElementById('restart-btn').style.display = 'none';
    document.getElementById('title-text').innerText = "é«˜é›…äººç”Ÿæ¨¡æ‹Ÿå™¨";

    if (selectedGenderTag === 'other') {
        finalGenderOrSpecies = speciesList[Math.floor(Math.random() * speciesList.length)];
    } else {
        finalGenderOrSpecies = selectedGenderTag === 'male' ? 'äººç±»ç”·æ€§' : 'äººç±»å¥³æ€§';
    }

    addLog(`è½¬ç”Ÿèº«ä»½:ã€${finalGenderOrSpecies}ã€‘`, false, false);
    
    gameInterval = setInterval(gameLoop, 1000); // ç¨å¾®æ”¾æ…¢é€Ÿåº¦ä¾¿äºé˜…è¯»
}

function gameLoop() {
    age++;
    
    if (checkSuddenDeath()) return;

    // å¯¿å‘½é€»è¾‘
    let maxAge = 80;
    if (!finalGenderOrSpecies.includes('äººç±»')) maxAge = 40; // åŠ¨ç‰©å¯¿å‘½çŸ­
    if (currentMode === 'xiuxian' || currentMode === 'xuanhuan') maxAge = 500;
    if (finalGenderOrSpecies === 'ä¸€æ£µæ ‘' || finalGenderOrSpecies === 'èµ›åšèŸ‘è‚') maxAge = 200;
    
    // è€æ­»é€»è¾‘ï¼Œå¢åŠ éšæœºæ€§
    if (age > maxAge && Math.random() < (0.1 + (age - maxAge)*0.02)) {
        die(`å¯¿ç»ˆæ­£å¯ï¼Œäº«å¹´${age}å²ã€‚`);
        return;
    }

    generateEvent();
    
    const logBox = document.getElementById('log-container');
    logBox.scrollTop = logBox.scrollHeight;
}

function checkSuddenDeath() {
    if (age <= 0) return false;
    let deathChance = 0.001; // é™ä½åŸºç¡€æ­»äº¡ç‡
    
    if (stats.body < 3) deathChance += 0.005;
    if (stats.luck < 2) deathChance += 0.01;
    if (currentMode === 'horror' || currentMode === 'cthulhu') deathChance += 0.03;

    if (Math.random() < deathChance) {
        let reason = "å–æ°´å‘›æ­»äº†ã€‚";
        if (currentMode === 'horror') reason = "ä½ çªç„¶æ¶ˆå¤±äº†ï¼Œåœ°ä¸Šåªå‰©ä¸€æ»©æ°´ã€‚";
        if (currentMode === 'xiuxian') reason = "ä½ èµ°ç«å…¥é­”ï¼Œçˆ†ä½“è€Œäº¡ã€‚";
        die(`ã€çªå‘æ¶è®¯ã€‘${reason}`);
        return true;
    }
    return false;
}

function die(msg) {
    clearInterval(gameInterval);
    isDead = true;
    addLog(msg, true);
    document.getElementById('restart-btn').style.display = 'block';
}

function generateEvent() {
    let text = "";
    let styleClass = "";
    let isHighlight = false;
    let isGolden = false;

    // ç‰¹æ®Šæ¨¡å¼è§¦å‘é€»è¾‘ (ä»…åœ¨æ­£å¸¸æ¨¡å¼ä¸”ä¸ºäººç±»æ—¶è§¦å‘)
    if (currentMode === 'normal' && finalGenderOrSpecies.includes('äººç±»') && age > 10 && age < 30 && Math.random() < 0.08) {
        const roll = Math.random();
        
        // ææ€–å‘éœ€è¦è­¦å‘Šï¼Œå…¶ä»–ç›´æ¥è·³
        if (roll < 0.15 && stats.iq > 5) {
            // ä¿®ä»™
            switchMode('xiuxian');
            addLog("ã€æœºç¼˜ã€‘ä½ æ¡åˆ°ä¸€å—æ¸©æ¶¦çš„ç‰ä½©ï¼Œè„‘æµ·ä¸­æµ®ç°å‡ºå¥‡å¼‚åŠŸæ³•ï¼", false, true);
            return;
        } else if (roll < 0.3 && stats.face > 6) {
            // æ‹çˆ±
            switchMode('2d');
            addLog("ã€çªå˜ã€‘ä¸–ç•Œçº¿å˜åŠ¨ï¼ä½ çš„ç”»é£å˜å¾—ç²¾è‡´èµ·æ¥äº†ã€‚", false, true);
            return;
        } else if (roll < 0.45) {
            // ç„å¹»
            switchMode('xuanhuan');
            addLog("ã€è§‰é†’ã€‘å¤©ç©ºä¸­åˆ’è¿‡ä¸€é“æµæ˜Ÿï¼Œç›´æ¥ç ¸å‘äº†ä½ ï¼", false, true);
            return;
        } else if (roll < 0.7) {
            // ææ€– (éœ€å¼¹çª—)
            pendingHorrorMode = 'horror';
            showHorrorModal('è§„åˆ™æ€ªè°ˆ');
            return;
        } else {
            // å…‹è‹é² (éœ€å¼¹çª—)
            pendingHorrorMode = 'cthulhu';
            showHorrorModal('å…‹è‹é²');
        return;
        }
    }

    // æ ¹æ®æ¨¡å¼ç”Ÿæˆæ–‡æœ¬
    if (currentMode === 'xiuxian') {
        styleClass = "xiuxian-text";
        // ä¿®ä»™æŠ‰æ‹©
        if (age === 50) {
            showChoice("å®—é—¨é­é‡ç­é¡¶ä¹‹ç¾ï¼Œé­”æ•™æ¥è¢­ï¼", [
                {text: "èª“æ­»å®ˆå«å®—é—¨", effect: () => { addLog("ä½ æˆ˜è‡³åŠ›ç«­ï¼Œä½†åœ¨ç»å¢ƒä¸­é¢†æ‚Ÿäº†å‰‘æ„ï¼", true, true); }},
                {text: "å¸¦ç€ç§˜ç±è·‘è·¯", effect: () => { addLog("ä½ è‹Ÿä¸”å·ç”Ÿï¼Œæˆä¸ºäº†æ•£ä¿®ã€‚", false); stats.luck -= 2; }}
            ]);
            return;
        }
        text = getNonRepeatingRandom(xiuxianEvents);

    } else if (currentMode === '2d') {
        styleClass = "anime-text";
        // æ‹çˆ±æŠ‰æ‹©
        if (age === 18) {
            showChoice("æ¯•ä¸šå…¸ç¤¼ä¸Šï¼Œä¸¤äººåŒæ—¶å‘ä½ å‘Šç™½ï¼", [
                {text: "é€‰æ‹©é’æ¢…ç«¹é©¬", effect: () => { addLog("æœç„¶è¿˜æ˜¯é™ªä¼´æœ€é•¿æƒ…ï¼Œä½ ä»¬è¿‡ä¸Šäº†ç”œèœœçš„ç”Ÿæ´»ã€‚", false, true); }},
                {text: "é€‰æ‹©å¤©é™ç³»è½¬æ ¡ç”Ÿ", effect: () => { addLog("å……æ»¡æ¿€æƒ…ä¸æœªçŸ¥çš„æ‹æƒ…å¼€å§‹äº†ï¼", false, true); }},
                {text: "æˆ‘å…¨éƒ½è¦ï¼ˆå±ï¼‰", effect: () => { die("ä½ è¢«æŸ´åˆ€äº†ã€‚ç»“å±€ï¼šå¥½èˆ¹ã€‚"); }}
            ]);
            return;
        }
        text = getNonRepeatingRandom(loveEvents);

    } else if (currentMode === 'horror') {
        styleClass = "horror-text";
        isHighlight = true;
        // ææ€–æŠ‰æ‹©
        if (age % 10 === 0) { // æ¯10å¹´ä¸€æ¬¡ç”Ÿå­˜æ£€å®š
            showChoice("åŠå¤œæœ‰äººç–¯ç‹‚æ•²é—¨ï¼ŒçŒ«çœ¼å¤–ä¸€ç‰‡æ¼†é»‘ã€‚", [
                {text: "å¼€é—¨æŸ¥çœ‹", effect: () => { die("æœ‰äº›é—¨æ˜¯ä¸èƒ½å¼€çš„ã€‚ä½ å˜æˆäº†å¤±è¸ªäººå£ã€‚"); }},
                {text: "èº²è¿›è¡£æŸœ", effect: () => { addLog("æ•²é—¨å£°æŒç»­äº†ä¸€å°æ—¶åæ¶ˆå¤±äº†ï¼Œä½ æ´»äº†ä¸‹æ¥ã€‚", true); }}
            ]);
            return;
        }
        text = getNonRepeatingRandom(horrorEvents);

    } else if (currentMode === 'cthulhu') {
        styleClass = "cthulhu-text";
        // å…‹è‹é²æŠ‰æ‹©
        if (age === 40) {
            showChoice("ä½ å‘ç°äº†ä¸€æœ¬ç”¨äººçš®è£…è®¢çš„ä¹¦ã€‚", [
                {text: "é˜…è¯»å®ƒ", effect: () => { addLog("ä½ ç†è§£äº†å®‡å®™çš„çœŸç†...ç„¶åç–¯äº†ã€‚", false, true); stats.iq = 999; }},
                {text: "çƒ§æ‰å®ƒ", effect: () => { addLog("ä¹¦å‘å‡ºå°–å«å£°åŒ–ä¸ºç°çƒ¬ï¼Œä½ æ„Ÿåˆ°ä¸€é˜µè½»æ¾ã€‚", false); }}
            ]);
            return;
        }
        text = getNonRepeatingRandom(cthulhuEvents);

    } else if (currentMode === 'xuanhuan') {
        styleClass = "xuanhuan-text";
        isGolden = true;
        text = getNonRepeatingRandom(xuanhuanEvents);

    } else {
        // æ­£å¸¸æ¨¡å¼
        if (age === 0) {
            text = "ä½ å‡ºç”Ÿäº†ï¼Œæ˜¯ä¸ªå¥åº·çš„å®å®ã€‚";
        } else if (!finalGenderOrSpecies.includes('äººç±»')) {
            // å¼‚ç§æ—
            let pool = speciesEvents[finalGenderOrSpecies] || humanEvents.adult;
            text = getNonRepeatingRandom(pool);
        } else {
            // äººç±»åˆ†é¾„å‰§æƒ…
            let pool = [];
            if (age <= 3) pool = humanEvents.baby;
            else if (age <= 12) pool = humanEvents.child;
            else if (age <= 18) pool = humanEvents.teen;
            else if (age <= 50) pool = humanEvents.adult;
            else pool = humanEvents.old;
            
            text = getNonRepeatingRandom(pool);
        }
    }

    addLog(text, isHighlight, isGolden, styleClass);
}

// å»é‡éšæœºå‡½æ•°
function getNonRepeatingRandom(arr) {
    let available = arr.filter(item => !recentEvents.includes(item));
    // å¦‚æœå¯ç”¨æ± ç©ºäº†ï¼Œå°±æ¸…ç©ºä¸€åŠå†å²è®°å½•
    if (available.length === 0) {
        recentEvents = recentEvents.slice(recentEvents.length / 2);
        available = arr;
    }
    const text = available[Math.floor(Math.random() * available.length)];
    
    recentEvents.push(text);
    if (recentEvents.length > 5) recentEvents.shift(); // ä¿æŒå†å²è®°å½•é•¿åº¦ä¸º5
    
    return text;
}

function switchMode(mode) {
    currentMode = mode;
    document.body.className = `mode-${mode}`;
    const titles = {
        'xiuxian': 'ä¿®ä»™æ¨¡æ‹Ÿå™¨',
        '2d': 'æ‹çˆ±å…»æˆæ¨¡æ‹Ÿå™¨',
        'horror': 'è§„åˆ™æ€ªè°ˆæ¨¡æ‹Ÿå™¨',
        'cthulhu': 'å…‹è‹é²æ¨¡æ‹Ÿå™¨',
        'xuanhuan': 'ç„å¹»æ¨¡æ‹Ÿå™¨'
    };
    document.getElementById('title-text').innerText = titles[mode] || 'é«˜é›…äººç”Ÿæ¨¡æ‹Ÿå™¨';
}

function showHorrorModal(modeName) {
    clearInterval(gameInterval);
    document.getElementById('modal-mode-name').innerText = modeName;
    document.getElementById('horror-modal').classList.add('active');
}

function confirmHorrorMode() {
    document.getElementById('horror-modal').classList.remove('active');
    if (pendingHorrorMode) {
        switchMode(pendingHorrorMode);
        addLog(`ã€ä¸–ç•Œçº¿å˜åŠ¨ã€‘ä½ æ„Ÿè§‰åˆ°å‘¨å›´çš„æ°”æ°›ä¸å¯¹åŠ²...è¿›å…¥${pendingHorrorMode}çº¿ï¼`, true, true);
        pendingHorrorMode = null;
    }
    gameInterval = setInterval(gameLoop, 1000);
}

function cancelHorrorMode() {
    document.getElementById('horror-modal').classList.remove('active');
    pendingHorrorMode = null;
    addLog("ä½ æ„Ÿåˆ°ä¸€é˜µå¯’æ„ï¼Œä½†ä½ å†³å®šæ— è§†å®ƒï¼Œç»§ç»­æ™®é€šçš„ç”Ÿæ´»ã€‚", false);
    gameInterval = setInterval(gameLoop, 1000);
}

function showChoice(title, options) {
    clearInterval(gameInterval);
    const logBox = document.getElementById('log-container');
    
    const choiceDiv = document.createElement('div');
    choiceDiv.className = 'choice-box';
    choiceDiv.innerHTML = `<div class="choice-title">${title}</div>`;
    
    options.forEach(opt => {
        const btn = document.createElement('button');
        btn.className = 'choice-btn';
        btn.innerText = opt.text;
        btn.onclick = () => {
            opt.effect();
            choiceDiv.remove();
            // åªæœ‰å½“æ²¡æœ‰æ­»äº¡æ—¶æ‰æ¢å¤å¾ªç¯
            if (!isDead) {
                gameInterval = setInterval(gameLoop, 1000);
            }
        };
        choiceDiv.appendChild(btn);
    });
    
    logBox.appendChild(choiceDiv);
    logBox.scrollTop = logBox.scrollHeight;
}

function addLog(text, isHighlight, isGolden, customClass) {
    const div = document.createElement('div');
    div.className = 'log-item';
    let content = `<span class="age-tag">${age}å²</span> ${text}`;
    if (age === -1) content = `<span class="age-tag" style="background:#95a5a6">ç³»ç»Ÿ</span> ${text}`;
    div.innerHTML = content;
    if (isHighlight) div.classList.add('highlight');
    if (isGolden) div.classList.add('golden');
    if (customClass) div.classList.add(customClass);
    document.getElementById('log-container').appendChild(div);
}

function resetGame() {
    switchScreen('screen-start');
    document.body.className = '';
    initSetup();
}

initSetup();
</script>

</body>
</html>